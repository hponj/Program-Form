<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Program Scheduler</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .delete-btn {
      background: none;
      border: none;
      font-size: 16px;
      cursor: pointer;
      color: black;
    }
    .program-list {
      background-color: #f8f9fa;
      border-radius: .25rem;
      padding: .5rem 1rem;
      margin-bottom: 1rem;
    }
    .check-table td {
      text-align: center;
      vertical-align: middle;
    }
  </style>
</head>
<body class="container my-4">

  <h2 class="mb-3">Program Scheduler</h2>

  <!-- Form Input Program -->
  <form id="programForm" class="row g-3 mb-4">
    <div class="col-md-3">
      <label class="form-label">Nama Program</label>
      <input type="text" id="namaProgram" class="form-control" required>
    </div>
    <div class="col-md-3">
      <label class="form-label">Tanggal Mulai</label>
      <input type="date" id="tanggalMulai" class="form-control">
    </div>
    <div class="col-md-3">
      <label class="form-label">Tanggal Selesai</label>
      <input type="date" id="tanggalSelesai" class="form-control">
    </div>
    <div class="col-md-3">
      <label class="form-label">Tingkat Kepentingan</label>
      <select id="kepentingan" class="form-select">
        <option>Tinggi</option>
        <option>Sedang</option>
        <option>Rendah</option>
      </select>
    </div>

    <div class="col-md-3">
      <label class="form-label">Bulan (opsional)</label>
      <select id="bulan" class="form-select">
        <option value="">Tidak Termasuk</option>
        <option value="01">Januari</option>
        <option value="02">Februari</option>
        <option value="03">Maret</option>
        <option value="04">April</option>
        <option value="05">Mei</option>
        <option value="06">Juni</option>
        <option value="07">Juli</option>
        <option value="08">Agustus</option>
        <option value="09">September</option>
        <option value="10">Oktober</option>
        <option value="11">November</option>
        <option value="12">Desember</option>
      </select>
    </div>
    <div class="col-md-3">
      <label class="form-label">Hari</label>
      <select id="hari" class="form-select">
        <option value="">Tidak Termasuk</option>
        <option>Senin</option>
        <option>Selasa</option>
        <option>Rabu</option>
        <option>Kamis</option>
        <option>Jumat</option>
        <option>Sabtu</option>
        <option>Minggu</option>
      </select>
    </div>
    <div class="col-md-3">
      <label class="form-label">Sesi</label>
      <select id="sesi" class="form-select">
        <option value="">Tidak Termasuk</option>
        <option value="pelajaran1">Pelajaran Pertama</option>
        <option value="pelajaran2">Pelajaran Kedua</option>
      </select>
    </div>
    <div class="col-md-3 d-flex align-items-end">
      <button type="submit" class="btn btn-primary w-100">Tambah Program</button>
    </div>
  </form>

  <!-- List Program Unik -->
  <div class="program-list">
    <h5>Daftar Program:</h5>
    <ul id="programList" class="mb-0"></ul>
  </div>

  <!-- Tabel Jadwal Mingguan -->
  <div class="card mt-3">
    <div class="card-header">Jadwal Mingguan</div>
    <div class="card-body">
      <table class="table table-bordered text-center">
        <thead class="table-light">
          <tr>
            <th>Hari</th>
            <th>Pelajaran Pertama</th>
            <th>Pelajaran Kedua</th>
          </tr>
        </thead>
        <tbody>
          <tr data-hari="Senin"><td>Senin</td><td class="pelajaran1"></td><td class="pelajaran2"></td></tr>
          <tr data-hari="Selasa"><td>Selasa</td><td class="pelajaran1"></td><td class="pelajaran2"></td></tr>
          <tr data-hari="Rabu"><td>Rabu</td><td class="pelajaran1"></td><td class="pelajaran2"></td></tr>
          <tr data-hari="Kamis"><td>Kamis</td><td class="pelajaran1"></td><td class="pelajaran2"></td></tr>
          <tr data-hari="Jumat"><td>Jumat</td><td class="pelajaran1"></td><td class="pelajaran2"></td></tr>
          <tr data-hari="Sabtu"><td>Sabtu</td><td class="pelajaran1"></td><td class="pelajaran2"></td></tr>
          <tr data-hari="Minggu"><td>Minggu</td><td class="pelajaran1"></td><td class="pelajaran2"></td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Tabel Catatan Program Bulanan -->
  <div class="card mt-3">
    <div class="card-header">Catatan Program Bulanan</div>
    <div class="card-body">
      <table class="table table-bordered text-center">
        <thead class="table-light">
          <tr>
            <th>Bulan</th>
            <th>Nama Program</th>
            <th>Tanggal Mulai</th>
            <th>Tanggal Selesai</th>
            <th>Hapus</th>
          </tr>
        </thead>
        <tbody id="bulanTableBody"></tbody>
      </table>
    </div>
  </div>

  <!-- ðŸ”¹ Tabel Catatan Check Bulanan -->
  <div class="card mt-3">
    <div class="card-header">Catatan Check Bulanan</div>
    <div class="card-body">
      <table class="table table-bordered text-center check-table">
        <thead class="table-light">
          <tr>
            <th>Tanggal</th>
            <th>Sudah Dikerjakan</th>
          </tr>
        </thead>
        <tbody id="checkBulanBody"></tbody>
      </table>
    </div>
  </div>

  <script>
    let programs = JSON.parse(localStorage.getItem('programs')) || [];
    let monthlyChecks = JSON.parse(localStorage.getItem('monthlyChecks')) || {};

    document.getElementById('programForm').addEventListener('submit', function(e){
      e.preventDefault();
      const nama = document.getElementById('namaProgram').value.trim();
      const mulai = document.getElementById('tanggalMulai').value;
      const selesai = document.getElementById('tanggalSelesai').value;
      const kepentingan = document.getElementById('kepentingan').value;
      const bulan = document.getElementById('bulan').value;
      const bulanNama = document.getElementById('bulan').selectedOptions[0].text;
      const hari = document.getElementById('hari').value;
      const sesi = document.getElementById('sesi').value;

      programs.push({nama, mulai, selesai, kepentingan, bulan, bulanNama, hari, sesi});
      localStorage.setItem('programs', JSON.stringify(programs));
      this.reset();
      renderPrograms();
    });

    function renderPrograms() {
      document.querySelectorAll('.pelajaran1, .pelajaran2').forEach(cell => cell.innerHTML = '');

      programs.forEach((prog, index) => {
        if (prog.hari && prog.sesi) {
          const div = document.createElement('div');
          div.className = 'p-2 mb-1 bg-light border rounded position-relative text-start';
          div.innerHTML = `
            <button type="button" class="btn-close btn-sm position-absolute top-0 end-0 m-1"></button>
            <strong>${prog.nama}</strong><br>
            ${prog.mulai && prog.selesai ? `${prog.mulai} - ${prog.selesai}` : 'Tanpa batas waktu'}<br>
            <span class="badge bg-${prog.kepentingan=='Tinggi'?'danger':prog.kepentingan=='Sedang'?'warning':'secondary'}">${prog.kepentingan}</span>
          `;
          div.querySelector('.btn-close').addEventListener('click', () => {
            programs.splice(index,1);
            localStorage.setItem('programs', JSON.stringify(programs));
            renderPrograms();
          });
          const cell = document.querySelector(`tr[data-hari="${prog.hari}"] .${prog.sesi}`);
          if(cell){
            cell.appendChild(div);
          }
        }
      });

      renderBulanTable();
      renderProgramList();
      renderCheckBulanan();
    }

    function renderBulanTable() {
      const tbody = document.getElementById('bulanTableBody');
      tbody.innerHTML = '';

      const namaBulanMap = {
        "01":"Januari","02":"Februari","03":"Maret","04":"April","05":"Mei","06":"Juni",
        "07":"Juli","08":"Agustus","09":"September","10":"Oktober","11":"November","12":"Desember"
      };

      const withBulan = programs.filter(p => p.bulan && p.bulan !== "");
      const seenNames = new Set();

      withBulan.forEach(prog => {
        if (!seenNames.has(prog.nama)) {
          seenNames.add(prog.nama);
          const bulanNama = prog.bulanNama || namaBulanMap[prog.bulan];
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${bulanNama}</td>
            <td>${prog.nama}</td>
            <td>${prog.mulai || '-'}</td>
            <td>${prog.selesai || '-'}</td>
            <td><button class="delete-btn" data-name="${prog.nama}">x</button></td>
          `;
          tbody.appendChild(tr);
        }
      });

      tbody.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const name = btn.dataset.name;
          programs = programs.filter(p => !(p.nama === name && p.bulan));
          localStorage.setItem('programs', JSON.stringify(programs));
          renderPrograms();
        });
      });
    }

    function renderProgramList() {
      const list = document.getElementById('programList');
      list.innerHTML = '';
      const names = [...new Set(programs.map(p => p.nama))];
      names.forEach(nama => {
        const li = document.createElement('li');
        li.textContent = nama;
        list.appendChild(li);
      });
    }

    // ðŸ”¹ Buat tabel 1â€“31 dengan checkbox
    function renderCheckBulanan() {
      const tbody = document.getElementById('checkBulanBody');
      tbody.innerHTML = '';
      for (let i = 1; i <= 31; i++) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${i}</td>
          <td><input type="checkbox" class="check-day" data-day="${i}" ${monthlyChecks[i] ? 'checked' : ''}></td>
        `;
        tbody.appendChild(tr);
      }

      document.querySelectorAll('.check-day').forEach(cb => {
        cb.addEventListener('change', () => {
          const day = cb.dataset.day;
          monthlyChecks[day] = cb.checked;
          localStorage.setItem('monthlyChecks', JSON.stringify(monthlyChecks));
        });
      });
    }

    renderPrograms();
  </script>
</body>
</html>
